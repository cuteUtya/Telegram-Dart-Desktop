import 'objects.dart';
import 'package:reflectable/reflectable.dart';

class Reflector extends Reflectable {
  const Reflector() :
        super(typeCapability, instanceInvokeCapability, newInstanceCapability);
}

const reflector = Reflector();

/// Attempts to parse an object as a [TdObject], or else returns the object
/// as is
dynamic tryConvertToTdObject(dynamic obj) {
  if (obj is Map) {
    return obj.containsKey('@type') ?
        //id dont know why, but just keep this int here
    (reflector.reflectType(classIndex[obj['@type']] ?? int) as ClassMirror)
        .newInstance('fromJson', [obj]) :
    obj;
  }

  return obj;
}

const Map<String, Type> classIndex = {
  "error" : Error,
  "ok" : Ok,
  "tdlibParameters" : TdlibParameters,
  "authenticationCodeType" : AuthenticationCodeType,
  "authenticationCodeInfo" : AuthenticationCodeInfo,
  "emailAddressAuthenticationCodeInfo" : EmailAddressAuthenticationCodeInfo,
  "textEntity" : TextEntity,
  "textEntities" : TextEntities,
  "formattedText" : FormattedText,
  "termsOfService" : TermsOfService,
  "authorizationState" : AuthorizationState,
  "passwordState" : PasswordState,
  "recoveryEmailAddress" : RecoveryEmailAddress,
  "temporaryPasswordState" : TemporaryPasswordState,
  "localFile" : LocalFile,
  "remoteFile" : RemoteFile,
  "file" : File,
  "inputFile" : InputFile,
  "photoSize" : PhotoSize,
  "minithumbnail" : Minithumbnail,
  "thumbnailFormat" : ThumbnailFormat,
  "thumbnail" : Thumbnail,
  "maskPoint" : MaskPoint,
  "maskPosition" : MaskPosition,
  "closedVectorPath" : ClosedVectorPath,
  "pollOption" : PollOption,
  "pollType" : PollType,
  "animation" : Animation,
  "audio" : Audio,
  "document" : Document,
  "photo" : Photo,
  "sticker" : Sticker,
  "video" : Video,
  "videoNote" : VideoNote,
  "voiceNote" : VoiceNote,
  "contact" : Contact,
  "location" : Location,
  "venue" : Venue,
  "game" : Game,
  "poll" : Poll,
  "profilePhoto" : ProfilePhoto,
  "chatPhotoInfo" : ChatPhotoInfo,
  "userType" : UserType,
  "botCommand" : BotCommand,
  "botCommands" : BotCommands,
  "chatLocation" : ChatLocation,
  "animatedChatPhoto" : AnimatedChatPhoto,
  "chatPhoto" : ChatPhoto,
  "chatPhotos" : ChatPhotos,
  "inputChatPhoto" : InputChatPhoto,
  "user" : User,
  "userFullInfo" : UserFullInfo,
  "users" : Users,
  "chatAdministrator" : ChatAdministrator,
  "chatAdministrators" : ChatAdministrators,
  "chatPermissions" : ChatPermissions,
  "chatMemberStatus" : ChatMemberStatus,
  "chatMember" : ChatMember,
  "chatMembers" : ChatMembers,
  "chatMembersFilter" : ChatMembersFilter,
  "supergroupMembersFilter" : SupergroupMembersFilter,
  "chatInviteLink" : ChatInviteLink,
  "chatInviteLinks" : ChatInviteLinks,
  "chatInviteLinkCount" : ChatInviteLinkCount,
  "chatInviteLinkCounts" : ChatInviteLinkCounts,
  "chatInviteLinkMember" : ChatInviteLinkMember,
  "chatInviteLinkMembers" : ChatInviteLinkMembers,
  "chatInviteLinkInfo" : ChatInviteLinkInfo,
  "basicGroup" : BasicGroup,
  "basicGroupFullInfo" : BasicGroupFullInfo,
  "supergroup" : Supergroup,
  "supergroupFullInfo" : SupergroupFullInfo,
  "secretChatState" : SecretChatState,
  "secretChat" : SecretChat,
  "messageSender" : MessageSender,
  "messageSenders" : MessageSenders,
  "messageForwardOrigin" : MessageForwardOrigin,
  "messageForwardInfo" : MessageForwardInfo,
  "messageReplyInfo" : MessageReplyInfo,
  "messageInteractionInfo" : MessageInteractionInfo,
  "messageSendingState" : MessageSendingState,
  "message" : Message,
  "messages" : Messages,
  "foundMessages" : FoundMessages,
  "sponsoredMessage" : SponsoredMessage,
  "sponsoredMessages" : SponsoredMessages,
  "notificationSettingsScope" : NotificationSettingsScope,
  "chatNotificationSettings" : ChatNotificationSettings,
  "scopeNotificationSettings" : ScopeNotificationSettings,
  "draftMessage" : DraftMessage,
  "chatType" : ChatType,
  "chatFilter" : ChatFilter,
  "chatFilterInfo" : ChatFilterInfo,
  "recommendedChatFilter" : RecommendedChatFilter,
  "recommendedChatFilters" : RecommendedChatFilters,
  "chatList" : ChatList,
  "chatLists" : ChatLists,
  "chatSource" : ChatSource,
  "chatPosition" : ChatPosition,
  "voiceChat" : VoiceChat,
  "chat" : Chat,
  "chats" : Chats,
  "chatNearby" : ChatNearby,
  "chatsNearby" : ChatsNearby,
  "publicChatType" : PublicChatType,
  "chatActionBar" : ChatActionBar,
  "keyboardButtonType" : KeyboardButtonType,
  "keyboardButton" : KeyboardButton,
  "inlineKeyboardButtonType" : InlineKeyboardButtonType,
  "inlineKeyboardButton" : InlineKeyboardButton,
  "replyMarkup" : ReplyMarkup,
  "loginUrlInfo" : LoginUrlInfo,
  "messageThreadInfo" : MessageThreadInfo,
  "richText" : RichText,
  "pageBlockCaption" : PageBlockCaption,
  "pageBlockListItem" : PageBlockListItem,
  "pageBlockHorizontalAlignment" : PageBlockHorizontalAlignment,
  "pageBlockVerticalAlignment" : PageBlockVerticalAlignment,
  "pageBlockTableCell" : PageBlockTableCell,
  "pageBlockRelatedArticle" : PageBlockRelatedArticle,
  "pageBlock" : PageBlock,
  "webPageInstantView" : WebPageInstantView,
  "webPage" : WebPage,
  "countryInfo" : CountryInfo,
  "countries" : Countries,
  "phoneNumberInfo" : PhoneNumberInfo,
  "bankCardActionOpenUrl" : BankCardActionOpenUrl,
  "bankCardInfo" : BankCardInfo,
  "address" : Address,
  "labeledPricePart" : LabeledPricePart,
  "invoice" : Invoice,
  "orderInfo" : OrderInfo,
  "shippingOption" : ShippingOption,
  "savedCredentials" : SavedCredentials,
  "inputCredentials" : InputCredentials,
  "paymentsProviderStripe" : PaymentsProviderStripe,
  "paymentFormTheme" : PaymentFormTheme,
  "paymentForm" : PaymentForm,
  "validatedOrderInfo" : ValidatedOrderInfo,
  "paymentResult" : PaymentResult,
  "paymentReceipt" : PaymentReceipt,
  "datedFile" : DatedFile,
  "passportElementType" : PassportElementType,
  "date" : Date,
  "personalDetails" : PersonalDetails,
  "identityDocument" : IdentityDocument,
  "inputIdentityDocument" : InputIdentityDocument,
  "personalDocument" : PersonalDocument,
  "inputPersonalDocument" : InputPersonalDocument,
  "passportElement" : PassportElement,
  "inputPassportElement" : InputPassportElement,
  "passportElements" : PassportElements,
  "passportElementErrorSource" : PassportElementErrorSource,
  "passportElementError" : PassportElementError,
  "passportSuitableElement" : PassportSuitableElement,
  "passportRequiredElement" : PassportRequiredElement,
  "passportAuthorizationForm" : PassportAuthorizationForm,
  "passportElementsWithErrors" : PassportElementsWithErrors,
  "encryptedCredentials" : EncryptedCredentials,
  "encryptedPassportElement" : EncryptedPassportElement,
  "inputPassportElementErrorSource" : InputPassportElementErrorSource,
  "inputPassportElementError" : InputPassportElementError,
  "messageContent" : MessageContent,
  "textEntityType" : TextEntityType,
  "inputThumbnail" : InputThumbnail,
  "messageSchedulingState" : MessageSchedulingState,
  "messageSendOptions" : MessageSendOptions,
  "messageCopyOptions" : MessageCopyOptions,
  "inputMessageContent" : InputMessageContent,
  "searchMessagesFilter" : SearchMessagesFilter,
  "chatAction" : ChatAction,
  "userStatus" : UserStatus,
  "stickers" : Stickers,
  "emojis" : Emojis,
  "stickerSet" : StickerSet,
  "stickerSetInfo" : StickerSetInfo,
  "stickerSets" : StickerSets,
  "callDiscardReason" : CallDiscardReason,
  "callProtocol" : CallProtocol,
  "callServerType" : CallServerType,
  "callServer" : CallServer,
  "callId" : CallId,
  "groupCallId" : GroupCallId,
  "callState" : CallState,
  "groupCallVideoQuality" : GroupCallVideoQuality,
  "groupCallRecentSpeaker" : GroupCallRecentSpeaker,
  "groupCall" : GroupCall,
  "groupCallVideoSourceGroup" : GroupCallVideoSourceGroup,
  "groupCallParticipantVideoInfo" : GroupCallParticipantVideoInfo,
  "groupCallParticipant" : GroupCallParticipant,
  "callProblem" : CallProblem,
  "call" : Call,
  "phoneNumberAuthenticationSettings" : PhoneNumberAuthenticationSettings,
  "animations" : Animations,
  "diceStickers" : DiceStickers,
  "importedContacts" : ImportedContacts,
  "httpUrl" : HttpUrl,
  "inputInlineQueryResult" : InputInlineQueryResult,
  "inlineQueryResult" : InlineQueryResult,
  "inlineQueryResults" : InlineQueryResults,
  "callbackQueryPayload" : CallbackQueryPayload,
  "callbackQueryAnswer" : CallbackQueryAnswer,
  "customRequestResult" : CustomRequestResult,
  "gameHighScore" : GameHighScore,
  "gameHighScores" : GameHighScores,
  "chatEventAction" : ChatEventAction,
  "chatEvent" : ChatEvent,
  "chatEvents" : ChatEvents,
  "chatEventLogFilters" : ChatEventLogFilters,
  "languagePackStringValue" : LanguagePackStringValue,
  "languagePackString" : LanguagePackString,
  "languagePackStrings" : LanguagePackStrings,
  "languagePackInfo" : LanguagePackInfo,
  "localizationTargetInfo" : LocalizationTargetInfo,
  "deviceToken" : DeviceToken,
  "pushReceiverId" : PushReceiverId,
  "backgroundFill" : BackgroundFill,
  "backgroundType" : BackgroundType,
  "background" : Background,
  "backgrounds" : Backgrounds,
  "inputBackground" : InputBackground,
  "themeSettings" : ThemeSettings,
  "chatTheme" : ChatTheme,
  "hashtags" : Hashtags,
  "canTransferOwnershipResult" : CanTransferOwnershipResult,
  "checkChatUsernameResult" : CheckChatUsernameResult,
  "checkStickerSetNameResult" : CheckStickerSetNameResult,
  "resetPasswordResult" : ResetPasswordResult,
  "messageFileType" : MessageFileType,
  "pushMessageContent" : PushMessageContent,
  "notificationType" : NotificationType,
  "notificationGroupType" : NotificationGroupType,
  "notification" : Notification,
  "notificationGroup" : NotificationGroup,
  "optionValue" : OptionValue,
  "jsonObjectMember" : JsonObjectMember,
  "jsonValue" : JsonValue,
  "userPrivacySettingRule" : UserPrivacySettingRule,
  "userPrivacySettingRules" : UserPrivacySettingRules,
  "userPrivacySetting" : UserPrivacySetting,
  "accountTtl" : AccountTtl,
  "session" : Session,
  "sessions" : Sessions,
  "connectedWebsite" : ConnectedWebsite,
  "connectedWebsites" : ConnectedWebsites,
  "chatReportReason" : ChatReportReason,
  "internalLinkType" : InternalLinkType,
  "messageLink" : MessageLink,
  "messageLinkInfo" : MessageLinkInfo,
  "filePart" : FilePart,
  "fileType" : FileType,
  "storageStatisticsByFileType" : StorageStatisticsByFileType,
  "storageStatisticsByChat" : StorageStatisticsByChat,
  "storageStatistics" : StorageStatistics,
  "storageStatisticsFast" : StorageStatisticsFast,
  "databaseStatistics" : DatabaseStatistics,
  "networkType" : NetworkType,
  "networkStatisticsEntry" : NetworkStatisticsEntry,
  "networkStatistics" : NetworkStatistics,
  "autoDownloadSettings" : AutoDownloadSettings,
  "autoDownloadSettingsPresets" : AutoDownloadSettingsPresets,
  "connectionState" : ConnectionState,
  "topChatCategory" : TopChatCategory,
  "tMeUrlType" : TMeUrlType,
  "tMeUrl" : TMeUrl,
  "tMeUrls" : TMeUrls,
  "suggestedAction" : SuggestedAction,
  "count" : Count,
  "text" : Text,
  "seconds" : Seconds,
  "deepLinkInfo" : DeepLinkInfo,
  "textParseMode" : TextParseMode,
  "proxyType" : ProxyType,
  "proxy" : Proxy,
  "proxies" : Proxies,
  "inputSticker" : InputSticker,
  "dateRange" : DateRange,
  "statisticalValue" : StatisticalValue,
  "statisticalGraph" : StatisticalGraph,
  "chatStatisticsMessageInteractionInfo" : ChatStatisticsMessageInteractionInfo,
  "chatStatisticsMessageSenderInfo" : ChatStatisticsMessageSenderInfo,
  "chatStatisticsAdministratorActionsInfo" : ChatStatisticsAdministratorActionsInfo,
  "chatStatisticsInviterInfo" : ChatStatisticsInviterInfo,
  "chatStatistics" : ChatStatistics,
  "messageStatistics" : MessageStatistics,
  "point" : Point,
  "vectorPathCommand" : VectorPathCommand,
  "botCommandScope" : BotCommandScope,
  "update" : Update,
  "updates" : Updates,
  "logStream" : LogStream,
  "logVerbosityLevel" : LogVerbosityLevel,
  "logTags" : LogTags,
  "testInt" : TestInt,
  "testString" : TestString,
  "testBytes" : TestBytes,
  "testVectorInt" : TestVectorInt,
  "testVectorIntObject" : TestVectorIntObject,
  "testVectorString" : TestVectorString,
  "testVectorStringObject" : TestVectorStringObject,
};
